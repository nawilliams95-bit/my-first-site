<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Realty Data Labs | Real Estate Intelligence</title>

  <!-- GLOBAL + HOME CSS -->
  <link rel="stylesheet" href="css/base.css" />
  <link rel="stylesheet" href="css/home.css" />
</head>

<body>

  <!-- HEADER -->
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="index.html">
        <img class="brand-logo" src="images/logo.jpg" alt="Realty Data Labs logo" />
        <span class="brand-name">Realty Data Labs</span>
      </a>

      <nav class="nav">
        <a href="index.html" class="active">Home</a>
        <a href="auth.html" class="nav-cta">Sign In / Sign Up</a>
        <a href="analyzer.html">Property Analyzer</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>
    </div>
  </header>

  <main>

    <!-- HERO -->
    <section class="hero">
      <div class="container hero-inner">
        <h1>Real Estate Intelligence, Updated Daily</h1>
        <p class="subhead">
          Live market context, mortgage rate benchmarks, and economic signals
          built for buyers, owners, investors, and agents.
        </p>
      </div>
    </section>

    <!-- INTELLIGENCE -->
    <section class="home-intelligence">
      <div class="container">

        <!-- NEWS -->
        <section class="news-section">
          <h2>Today’s Real Estate and Economic News</h2>

          <div class="news-feed">
            <article class="news-item">
              <span class="news-source">Loading</span>
              <h3>Fetching the latest housing and economic headlines…</h3>
              <time>—</time>
            </article>
          </div>
        </section>

        <!-- MARKET DATA -->
        <section class="market-section">

          <!-- MORTGAGE RATES -->
          <div class="market-box">
            <h2>National Mortgage Rate Averages</h2>

            <p class="data-disclaimer">
              Rates shown are Freddie Mac Primary Mortgage Market Survey (PMMS)
              national averages. PMMS reflects lender reported pricing trends
              and is published weekly. Rates are benchmarks only and not loan offers.
            </p>

            <p class="data-note">
              Freddie Mac PMMS national averages. Updated weekly.
            </p>

            <p class="data-note">
              As of <span id="pmmsAsOf">—</span>. Next update expected
              <span id="pmmsNext">—</span>.
            </p>

            <table class="rates-table">
              <tbody>
                <tr>
                  <td>30-Year Fixed</td>
                  <td id="rate30">—</td> <!-- Display 30-year rate -->
                </tr>
                <tr>
                  <td>15-Year Fixed</td>
                  <td id="rate15">—</td> <!-- Display 15-year rate -->
                </tr>
                <tr>
                  <td>5/1 ARM</td>
                  <td id="rateARM">—</td> <!-- Display ARM rate -->
                </tr>
              </tbody>
            </table>
          </div>

          <!-- TREASURY -->
          <div class="market-box">
            <h2>10-Year Treasury Yield</h2>

            <div class="treasury-value" id="treasury10">—</div> <!-- Display Treasury Yield -->

            <div class="treasury-chart-wrap">
              <canvas id="treasuryChart"></canvas> <!-- Chart for Treasury Yield -->
            </div>

            <p class="data-note">
              30-day yield trend. Source: U.S. Treasury via FRED.
            </p>
          </div>

        </section>

      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container footer-inner">

      <nav class="footer-nav">
        <a href="index.html">Home</a>
        <a href="auth.html">Sign In / Sign Up</a>
        <a href="analyzer.html">Property Analyzer</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>

      <div class="footer-disclaimer">
        <p>
          Realty Data Labs provides general real estate, housing market,
          and economic information for educational purposes only.
        </p>
        <p>
          The author of this site is a licensed real estate agent in the State of Georgia.
        </p>
      </div>

      <p class="footer-meta">
        © <span id="year"></span> Realty Data Labs. All rights reserved.
      </p>

    </div>
  </footer>

  <!-- FOOTER YEAR -->
  <script>
    document.getElementById("year").textContent =
      new Date().getFullYear();
  </script>

  <!-- SCRIPTS -->
  <script src="js/news.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="js/rates.js"></script>

  <!-- Updated JS for Dynamic Treasury Yield and Chart -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {

      // Mortgage Rates Snapshot (dynamic fetching)
      function fetchMortgageRates() {
        const apiKey = 'dcc865cd79fab774a29ff8469d345622';  // Replace with your actual FRED API key
        const url = `https://api.stlouisfed.org/fred/series/observations?series_id=IR14290&api_key=${apiKey}&file_type=json`;

        fetch(url)
          .then(response => response.json())
          .then(data => {
            const rate30 = data.observations[0].value;  // Get the latest 30-year rate
            document.getElementById('rate30').textContent = rate30 + '%';

            const rate15 = data.observations[1].value;  // Get the latest 15-year rate
            document.getElementById('rate15').textContent = rate15 + '%';

            const rateARM = data.observations[2].value;  // Get the latest 5/1 ARM rate
            document.getElementById('rateARM').textContent = rateARM + '%';
          })
          .catch(error => {
            console.error('Error fetching mortgage rates:', error);
            document.getElementById('rate30').textContent = 'N/A';
            document.getElementById('rate15').textContent = 'N/A';
            document.getElementById('rateARM').textContent = 'N/A';
          });
      }

      // Fetch the 10-Year Treasury Yield Data
      function fetchTreasuryData() {
        const apiKey = 'dcc865cd79fab774a29ff8469d345622';  // FRED API key
        const url = `https://api.stlouisfed.org/fred/series/observations?series_id=DGS10&api_key=${apiKey}&file_type=json`;

        fetch(url)
          .then(response => response.json())
          .then(data => {
            const latestTreasuryYield = data.observations[0].value;  // Get the latest 10-year yield

            // Update the displayed yield
            const treasuryValue = document.getElementById('treasury10');
            if (treasuryValue) treasuryValue.textContent = `${latestTreasuryYield}%`;  // Display the yield value

            // Example data for chart (last 30 data points)
            const dataPoints = data.observations.slice(0, 30).map(obs => parseFloat(obs.value));  // Get the last 30 data points

            // Update the chart with the new data
            updateTreasuryChart(dataPoints);
          })
          .catch(error => {
            console.error('Error fetching Treasury data:', error);
            document.getElementById('treasury10').textContent = 'N/A';
          });
      }

      // Update the Treasury Yield Chart
      function updateTreasuryChart(data) {
        const ctx = document.getElementById('treasuryChart').getContext('2d');

        // Destroy the old chart if it exists
        if (window.myChart) {
          window.myChart.destroy();  // Destroy existing chart instance
        }

        // Create a new chart instance with updated data
        window.myChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: data.map((_, i) => `Day ${i + 1}`),  // Example labels: Day 1, Day 2, etc.
            datasets: [{
              data,
              borderWidth: 2,
              tension: 0.35,
              pointRadius: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
              x: { display: false },
              y: {
                ticks: { callback: v => v + "%" }
              }
            }
          }
        });
      }

      // Fetch data when the page loads
      fetchMortgageRates();
      fetchTreasuryData();

      // Update data every hour (3600000 milliseconds = 1 hour)
      setInterval(function () {
        fetchMortgageRates();
        fetchTreasuryData();
      }, 3600000);  // Update every hour

    });
  </script>

</body>
</html>